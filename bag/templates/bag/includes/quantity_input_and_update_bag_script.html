<script type="text/javascript">

    // Listen to changes on the input box to enable/disable buttons
    // Set the value to min or max depending on input after giving feedback
    $('.qty_input').change(function() {
        let itemId = $(this).data('item_id');
        let currentInput = $(this)
        let currentValue = parseInt($(`#id_qty_${itemId}`).val());
        let maxValue = parseInt($(`#id_qty_${itemId}`).attr('max'));
        if ( currentValue > maxValue ){
            let quantityFeedback = $(`#too_high_qty_${itemId}`);
            quantityFeedback.show();
            // Credit to zzzzBov for hiding element after a period of time 
            // [stackoverflow](https://stackoverflow.com/questions/4127527/how-to-show-div-for-10-seconds-and-then-hide-it)
            setTimeout(function(){
                quantityFeedback.hide();
            }, 4000);
            // The value shown is different than the real value ???????????????
            currentInput.val(maxValue);
            handleEnableDisable(itemId);

        } else if ( currentValue <= 0 ) {
            let quantityFeedback = $(`#too_small_qty_${itemId}`);
            quantityFeedback.show();
            setTimeout(function(){
                quantityFeedback.hide();
            }, 4000);
            currentInput.val(1);
            handleEnableDisable(itemId);
        }
        let form = $(this).closest('.update-form');
        form.submit();
    });

</script>